# Отчёт о выполнении лабораторной работы: Ansible, DNS и NGINX

## 1. Подготовка инфраструктуры
- **Узлы**: 
  - `k8s-master` (192.168.1.92) — сервер управления Ansible.
  - `k8s-worker-1` (192.168.1.93)
  - `k8s-worker-2` (192.168.1.94)
- **Доступ**: Настроен беспарольный доступ по SSH по ключам ED25519 между всеми узлами и локальной машиной.
- **Ansible**: Установлен на `k8s-master`. Проект развернут в `~/ansible-lab`.

## 2. Роль DNS (BIND9)
- **Конфигурация**: Сервер настроен как Master для зоны `mpsu.stu`.
- **Записи**:
  - `k8s-master.mpsu.stu` -> A 192.168.1.92
  - `web.mpsu.stu` -> CNAME k8s-master.mpsu.stu
- **Валидация**: 
  - `named-checkconf`: OK
  - `named-checkzone`: OK
- **Результат проверки**:
  ```bash
  $ dig @localhost master.mpsu.stu +short
  k8s-master.mpsu.stu.
  192.168.1.92
  ```

## 3. Роль Web (NGINX)
- **Конфигурация сервера**:
  - `worker_processes` динамически устанавливается исходя из количества ядер (используется переменная `ansible_processor_vcpus`).
  - Метод обработки соединений установлен в `epoll`.
  - Лимит `worker_connections` установлен в 2048.
- **Виртуальные хосты**:
  - Настроены два сайта: `master.mpsu.stu` и `alias.mpsu.stu`.
  - Каждый сайт имеет свою корневую директорию (`/var/www/site_a` и `/var/www/site_b`) и уникальную страницу `index.html`.
- **Результат проверки (curl)**:
  - **Сайт 1**:
    ```html
    <html><body><h1>Welcome to master.mpsu.stu</h1>...</body></html>
    ```
  - **Сайт 2**:
    ```html
    <html><body><h1>Welcome to alias.mpsu.stu</h1>...</body></html>
    ```

## 4. Выводы
Задание выполнено в полном объеме. Все компоненты системы (DNS и Web-сервер) успешно развернуты и настроены с помощью Ansible. Конфигурация соответствует заданным требованиям безопасности и производительности.

**Статус**: Успешно завершено.
